"use strict";define("forum/category",["forum/infinitescroll","share","navigator","topicList","sort"],function(t,o,a,i,n){var e={};$(window).on("action:ajaxify.start",function(t,o){if(!String(o.url).startsWith("category/")){a.disable()}});e.init=function(){var t=ajaxify.data.cid;app.enterRoom("category_"+t);o.addShareHandlers(ajaxify.data.name);i.init("category",g);n.handleSort("categoryTopicSort","category/"+ajaxify.data.slug);if(!config.usePagination){a.init('[component="category/topic"]',ajaxify.data.topic_count,e.toTop,e.toBottom,e.navigatorCallback)}else{a.disable()}c();r(t);$(window).trigger("action:topics.loaded",{topics:ajaxify.data.topics});$(window).trigger("action:category.loaded",{cid:ajaxify.data.cid})};function c(){var t=ajaxify.data.topicIndex;if(t&&utils.isNumber(t)){t=Math.max(0,parseInt(t,10));if(t&&window.location.search.indexOf("page=")===-1){a.scrollToElement($('[component="category/topic"][data-index="'+t+'"]'),true,0)}}}function r(t){$('[component="category/watching"], [component="category/ignoring"], [component="category/notwatching"]').on("click",function(){var o=$(this);var a=o.attr("data-state");socket.emit("categories.setWatchState",{cid:t,state:a},function(t){if(t){return app.alertError(t.message)}$('[component="category/watching/menu"]').toggleClass("hidden",a!=="watching");$('[component="category/watching/check"]').toggleClass("fa-check",a==="watching");$('[component="category/notwatching/menu"]').toggleClass("hidden",a!=="notwatching");$('[component="category/notwatching/check"]').toggleClass("fa-check",a==="notwatching");$('[component="category/ignoring/menu"]').toggleClass("hidden",a!=="ignoring");$('[component="category/ignoring/check"]').toggleClass("fa-check",a==="ignoring");app.alertSuccess("[[category:"+a+".message]]")})})}e.toTop=function(){a.scrollTop(0)};e.toBottom=function(){socket.emit("categories.getTopicCount",ajaxify.data.cid,function(t,o){if(t){return app.alertError(t.message)}a.scrollBottom(o-1)})};e.navigatorCallback=function(t,o){return o};function g(o,a,i){i=i||function(){};$(window).trigger("action:category.loading");var n=utils.params();t.loadMore("categories.loadMore",{cid:ajaxify.data.cid,after:o,direction:a,query:n,categoryTopicSort:config.categoryTopicSort},function(t,o){$(window).trigger("action:category.loaded");i(t,o)})}return e});
//# sourceMappingURL=category.js.map