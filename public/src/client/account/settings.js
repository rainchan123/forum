"use strict";define("forum/account/settings",["forum/account/header","components","translator","api"],function(e,t,a,n){var i={};$(window).on("action:ajaxify.start",function(){if(ajaxify.data.template.name==="account/settings"&&$("#bootswatchSkin").val()!==config.bootswatchSkin){c(config.bootswatchSkin)}});i.init=function(){e.init();$("#submitBtn").on("click",function(){var e=o();if(e.homePageRoute==="custom"&&e.homePageCustom){$.get(config.relative_path+"/"+e.homePageCustom,function(){r(e)}).fail(function(){app.alertError("[[error:invalid-home-page-route]]")})}else{r(e)}return false});$("#bootswatchSkin").on("change",function(){c($(this).val())});$('[data-property="homePageRoute"]').on("change",s);s();t.get("user/sessions").find(".timeago").timeago()};function o(){var e={};$(".account").find("input, textarea, select").each(function(t,a){a=$(a);var n=a.attr("data-property");if(a.is("select")){e[n]=a.val();return}switch(a.attr("type")){case"text":case"textarea":e[n]=a.val();break;case"checkbox":e[n]=a.is(":checked")?1:0;break}});return e}function r(e){n.put(`/users/${ajaxify.data.uid}/settings`,{settings:e}).then(e=>{app.alertSuccess("[[success:settings-saved]]");var t=false;for(var n in e){if(e.hasOwnProperty(n)){if(n==="userLang"&&config.userLang!==e.userLang){t=true}if(config.hasOwnProperty(n)){config[n]=e[n]}}}if(t&&parseInt(app.user.uid,10)===parseInt(ajaxify.data.theirid,10)){a.translate("[[language:dir]]",config.userLang,function(e){var t=$("html");t.attr("data-dir",e);t.css("direction",e)});a.switchTimeagoLanguage(utils.userLangToTimeagoCode(config.userLang),function(){overrides.overrideTimeago();ajaxify.refresh()})}})}function s(){if($('[data-property="homePageRoute"]').val()==="custom"){$("#homePageCustom").show()}else{$("#homePageCustom").hide();$('[data-property="homePageCustom"]').val("")}}function c(e){var t=Array.prototype.filter.call(document.querySelectorAll('link[rel="stylesheet"]'),function(e){return e.href.indexOf(config.relative_path+"/assets/client")!==-1})[0]||null;if(!t){return}var a=$("body").attr("class").split(/\s+/).filter(function(e){return e.startsWith("skin-")});if(!a[0]){return}var n=a[0].slice(5);n=n!=="noskin"?n:"";if(e===n){return}var i=document.createElement("link");i.rel="stylesheet";i.type="text/css";i.href=config.relative_path+"/assets/client"+(e?"-"+e:"")+".css";i.onload=function(){t.parentNode.removeChild(t);$("body").removeClass(a.join(" "));$("body").addClass("skin-"+(e||"noskin"))};document.head.appendChild(i)}return i});
//# sourceMappingURL=settings.js.map