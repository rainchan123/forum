"use strict";define("forum/account/edit/password",["forum/account/header","translator","zxcvbn","api"],function(a,s,e,r){var o={};o.init=function(){a.init();n()};function n(){var a=$("#inputCurrentPassword");var s=$("#password-notify");var o=$("#password-confirm-notify");var n=$("#inputNewPassword");var l=$("#inputNewPasswordAgain");var d=false;var u=false;function f(){var a=e(n.val());d=false;if(n.val().length<ajaxify.data.minimumPasswordLength){i(s,"[[reset_password:password_too_short]]")}else if(n.val().length>512){i(s,"[[error:password-too-long]]")}else if(!utils.isPasswordValid(n.val())){i(s,"[[user:change_password_error]]")}else if(n.val()===ajaxify.data.username){i(s,"[[user:password_same_as_username]]")}else if(n.val()===ajaxify.data.email){i(s,"[[user:password_same_as_email]]")}else if(a.score<ajaxify.data.minimumPasswordStrength){i(s,"[[user:weak_password]]")}else{t(s);d=true}}function c(){if(n.val()!==l.val()){i(o,"[[user:change_password_error_match]]");u=false}else{if(n.val()){t(o)}else{o.parent().removeClass("alert-success alert-danger");o.children().show();o.find(".msg").html("")}u=true}}n.on("blur",f);l.on("blur",c);$("#changePasswordBtn").on("click",function(){f();c();var e=$(this);if(d&&u){e.addClass("disabled").find("i").removeClass("hide");r.put("/users/"+ajaxify.data.theirid+"/password",{currentPassword:a.val(),newPassword:n.val()}).then(()=>{if(parseInt(app.user.uid,10)===parseInt(ajaxify.data.uid,10)){window.location.href=config.relative_path+"/login"}else{ajaxify.go("user/"+ajaxify.data.userslug+"/edit")}}).finally(()=>{e.removeClass("disabled").find("i").addClass("hide");a.val("");n.val("");l.val("");s.parent().removeClass("show-success show-danger");o.parent().removeClass("show-success show-danger");u=false;d=false})}else{if(!u){app.alertError("[[user:change_password_error_match]]")}if(!d){app.alertError("[[user:change_password_error]]")}}return false})}function i(a,e){s.translate(e,function(s){a.html(s);a.parent().removeClass("show-success").addClass("show-danger")})}function t(a){a.html("");a.parent().removeClass("show-danger").addClass("show-success")}return o});
//# sourceMappingURL=password.js.map