"use strict";define("forum/topic/votes",["components","translator","benchpress","api"],function(t,e,o,r){var a={};a.addVoteHandler=function(){t.get("topic").on("mouseenter",'[data-pid] [component="post/vote-count"]',n)};function n(t){t.stopPropagation();var e=$(this);var o=e.parent();o.find(".tooltip").css("display","none");var r=o.parents("[data-pid]").attr("data-pid");socket.emit("posts.getUpvoters",[r],function(t,o){if(t){return app.alertError(t.message)}if(o.length){i(e,o[0])}});return false}function i(t,o){function r(e){t.attr("title",e).tooltip("fixTitle").tooltip("show");t.parent().find(".tooltip").css("display","")}var a=o.usernames.filter(t=>t!=="[[global:former_user]]");if(!a.length){return}if(a.length+o.otherCount>6){a=a.join(", ").replace(/,/g,"|");e.translate("[[topic:users_and_others, "+a+", "+o.otherCount+"]]",function(t){t=t.replace(/\|/g,",");r(t)})}else{a=a.join(", ");r(a)}}a.toggleVote=function(t,e,o){var a=t.closest("[data-pid]");var n=a.find(e).length;const i=n?"del":"put";var s=a.attr("data-pid");r[i](`/posts/${s}/vote`,{delta:o},function(t){if(t){if(t.message==="[[error:not-logged-in]]"){ajaxify.go("login");return}return app.alertError(t.message)}$(window).trigger("action:post.toggleVote",{pid:s,delta:o,unvote:i==="del"})});return false};a.showVotes=function(t){socket.emit("posts.getVoters",{pid:t,cid:ajaxify.data.cid},function(t,e){if(t){if(t.message==="[[error:no-privileges]]"){return}return app.alertError(t.message)}app.parseAndTranslate("partials/modals/votes_modal",e,function(t){var e=bootbox.dialog({title:"[[global:voters]]",message:t,className:"vote-modal",show:true});e.on("click",function(){e.modal("hide")})})})};return a});
//# sourceMappingURL=votes.js.map