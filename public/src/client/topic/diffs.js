"use strict";define("forum/topic/diffs",["api","forum/topic/images"],function(t){var e={};e.open=function(s){if(!config.enablePostHistory){return}var a={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"};t.get(`/posts/${s}/diffs`,{}).then(t=>{app.parseAndTranslate("partials/modals/post_history",{diffs:t.revisions.map(function(t){var e=parseInt(t.timestamp,10);return{username:t.username,timestamp:e,pretty:new Date(e).toLocaleString(config.userLang.replace("_","-"),a)}}),numDiffs:t.timestamps.length,editable:t.editable},function(a){var r=bootbox.dialog({title:"[[topic:diffs.title]]",message:a,size:"large"});if(!t.timestamps.length){return}var i=r.find("select");var n=r.find('button[data-action="restore"]');var o=r.find("ul.posts-list");i.on("change",function(){e.load(s,this.value,o);n.prop("disabled",t.timestamps.indexOf(this.value)===0)});n.on("click",function(){e.restore(s,i.val(),r)});r.on("shown.bs.modal",function(){e.load(s,i.val(),o);n.prop("disabled",true)})})}).catch(app.alertError)};e.load=function(e,s,a){if(!config.enablePostHistory){return}t.get(`/posts/${e}/diffs/${s}`,{}).then(t=>{t.deleted=!!parseInt(t.deleted,10);app.parseAndTranslate("partials/posts_list","posts",{posts:[t]},function(t){a.empty().append(t)})}).catch(app.alertError)};e.restore=function(e,s,a){if(!config.enablePostHistory){return}t.put(`/posts/${e}/diffs/${s}`,{}).then(()=>{a.modal("hide");app.alertSuccess("[[topic:diffs.post-restored]]")}).catch(app.alertError)};return e});
//# sourceMappingURL=diffs.js.map