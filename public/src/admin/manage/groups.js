"use strict";define("admin/manage/groups",["categorySelector","slugify","api"],function(a,e,t){var r={};var n=0;r.init=function(){var a=$("#create-modal");var r=$("#create-group-name");var n=$("#create-modal-go");var s=$("#create-modal-error");i();a.on("keypress",function(a){if(a.keyCode===13){n.click()}});$("#create").on("click",function(){a.modal("show");setTimeout(function(){r.focus()},250)});n.on("click",function(){var e={name:r.val(),description:$("#create-group-desc").val(),private:$("#create-group-private").is(":checked")?1:0,hidden:$("#create-group-hidden").is(":checked")?1:0};t.post("/groups",e).then(e=>{s.addClass("hide");r.val("");a.on("hidden.bs.modal",function(){ajaxify.go("admin/manage/groups/"+e.name)});a.modal("hide")}).catch(a=>{if(!utils.hasLanguageKey(a.status.message)){a.status.message="[[admin/manage/groups:alerts.create-failure]]"}s.translateHtml(a.status.message).removeClass("hide")})});$(".groups-list").on("click","[data-action]",function(){var a=$(this);var r=a.attr("data-action");var n=a.parents("tr[data-groupname]").attr("data-groupname");switch(r){case"delete":bootbox.confirm("[[admin/manage/groups:alerts.confirm-delete]]",function(a){if(a){t.del(`/groups/${e(n)}`,{}).then(ajaxify.refresh).catch(app.alertError)}});break}});o()};function o(){$('.groups-list [component="category-selector"]').each(function(){var e=$(this).parents("[data-name-encoded]").attr("data-name-encoded");a.init($(this),function(a){ajaxify.go("admin/manage/privileges/"+a.cid+"?group="+e)})})}function i(){var a=$("#group-search");function e(){if(!a.val()){return ajaxify.refresh()}$(".pagination").addClass("hide");var e=$(".groups-list");socket.emit("groups.search",{query:a.val(),options:{sort:"date"}},function(a,t){if(a){return app.alertError(a.message)}app.parseAndTranslate("admin/manage/groups","groups",{groups:t,categories:ajaxify.data.categories},function(a){e.find("[data-groupname]").remove();e.find("tbody").append(a);o()})})}a.on("keyup",function(){if(n){clearTimeout(n);n=0}n=setTimeout(e,200)})}return r});
//# sourceMappingURL=groups.js.map