"use strict";define("admin/settings/navigation",["translator","iconSelect","benchpress","jquery-ui/widgets/draggable","jquery-ui/widgets/droppable","jquery-ui/widgets/sortable"],function(a,e,n){var i={};var t;i.init=function(){t=ajaxify.data.available;$("#available").find("li .drag-item").draggable({connectToSortable:"#active-navigation",helper:"clone",distance:10,stop:r});$("#active-navigation").sortable().droppable({accept:$("#available li .drag-item")});$("#enabled").on("click",".iconPicker",function(){var a=$(this).find("i");e.init(a,function(e){var n=e.attr("value");var i=a.parents("[data-index]").attr("data-index");$('#active-navigation [data-index="'+i+'"] i').attr("class","fa fa-fw "+n);a.siblings('[name="iconClass"]').val(n);a.siblings(".change-icon-link").toggleClass("hidden",!!n)})});$("#active-navigation").on("click","li",s);$("#enabled").on("click",".delete",o).on("click",".toggle",d);$("#save").on("click",l)};function s(){var a=$(this).attr("data-index");$("#active-navigation li").removeClass("active");$(this).addClass("active");var e=$("#enabled").children('[data-index="'+a+'"]');$("#enabled li").addClass("hidden");if(e.length){e.removeClass("hidden")}return false}function r(e,i){var s=i.helper.attr("data-id");var r=$('#active-navigation [data-id="'+s+'"]');var l=s==="custom"?{iconClass:"fa-navicon",groups:t[0].groups}:t[s];l.enabled=false;l.index=(parseInt($("#enabled").children().last().attr("data-index"),10)||0)+1;l.title=a.escape(l.title);l.text=a.escape(l.text);l.groups=ajaxify.data.groups;n.parse("admin/settings/navigation","navigation",{navigation:[l]},function(e){a.translate(e,function(e){e=$(a.unescape(e));r.after(e);r.remove()})});n.parse("admin/settings/navigation","enabled",{enabled:[l]},function(e){a.translate(e,function(e){e=$(a.unescape(e));$("#enabled").append(e);componentHandler.upgradeDom()})})}function l(){var a=[];var e=[];$("#active-navigation li").each(function(){e.push($(this).attr("data-index"))});e.forEach(function(e){var n=$("#enabled").children('[data-index="'+e+'"]');var i=n.find("form").serializeArray();var t={};var s={};i.forEach(function(a){if(a.name.slice(0,9)==="property:"&&a.value==="on"){s[a.name.slice(9)]=true}else if(t[a.name]){if(!Array.isArray(t[a.name])){t[a.name]=[t[a.name]]}t[a.name].push(a.value)}else{t[a.name]=a.value}});t.properties={};for(var r in s){if(s.hasOwnProperty(r)){t.properties[r]=s[r]}}a.push(t)});socket.emit("admin.navigation.save",a,function(a){if(a){app.alertError(a.message)}else{app.alertSuccess("Successfully saved navigation")}})}function o(){var a=$(this).parents("[data-index]").attr("data-index");$('#active-navigation [data-index="'+a+'"]').remove();$('#enabled [data-index="'+a+'"]').remove();return false}function d(){var e=$(this);var n=e.hasClass("btn-success");a.translate(n?"[[admin/settings/navigation:btn.disable]]":"[[admin/settings/navigation:btn.enable]]",function(a){e.toggleClass("btn-warning").toggleClass("btn-success").html(a);e.parents("li").find('[name="enabled"]').val(n?"on":"")});return false}return i});
//# sourceMappingURL=navigation.js.map