"use strict";define("admin/extend/rewards",[],function(){var a={};var e;var t;var r;var n;a.init=function(){e=ajaxify.data.rewards;t=ajaxify.data.active;r=ajaxify.data.conditions;n=ajaxify.data.conditionals;$("[data-selected]").each(function(){i($(this))});$("#active").on("change","[data-selected]",function(){s($(this))}).on("click",".delete",function(){var a=$(this).parents("[data-id]");var e=a.attr("data-id");socket.emit("admin.rewards.delete",{id:e},function(a){if(a){app.alertError(a.message)}else{app.alertSuccess("[[admin/extend/rewards:alert.delete-success]]")}});a.remove();return false}).on("click",".toggle",function(){var a=$(this);var e=a.hasClass("btn-success");a.toggleClass("btn-warning").toggleClass("btn-success").translateHtml("[[admin/extend/rewards:"+(e?"disable":"enable")+"]]");return false});$("#new").on("click",l);$("#save").on("click",o);c()};function i(a){a.val(a.attr("data-selected"));switch(a.attr("name")){case"rid":d(a);break}}function s(a){a.attr("data-selected",a.val());switch(a.attr("name")){case"rid":d(a);break}}function d(a){var t=a.parents("[data-rid]");var r=t.find(".inputs");var n;var i="";for(var s in e){if(e.hasOwnProperty(s)){if(e[s].rid===a.attr("data-selected")){n=e[s].inputs;t.attr("data-rid",e[s].rid);break}}}if(!n){return app.alertError("[[admin/extend/rewards:alert.no-inputs-found]] "+a.attr("data-selected"))}n.forEach(function(a){i+='<label for="'+a.name+'">'+a.label+"<br />";switch(a.type){case"select":i+='<select name="'+a.name+'">';a.values.forEach(function(a){i+='<option value="'+a.value+'">'+a.name+"</option>"});break;case"text":i+='<input type="text" name="'+a.name+'" />';break}i+="</label><br />"});r.html(i)}function c(){$("[data-rid]").each(function(a){var e=$(this).find(".inputs");var r=t[a].rewards;for(var n in r){if(r.hasOwnProperty(n)){e.find('[name="'+n+'"]').val(r[n])}}})}function l(){var a=$("#active");var t={active:[{disabled:true,value:"",claimable:1,rid:null,id:null}],conditions:r,conditionals:n,rewards:e};app.parseAndTranslate("admin/extend/rewards","active",t,function(e){a.append(e);e.find("select").val("")})}function o(){var a=[];$("#active li").each(function(){var e={rewards:{}};var t=$(this).find("form.main").serializeArray();var r=$(this).find("form.rewards").serializeArray();t.forEach(function(a){e[a.name]=a.value});r.forEach(function(a){e.rewards[a.name]=a.value});e.id=$(this).attr("data-id");e.disabled=$(this).find(".toggle").hasClass("btn-success");a.push(e)});socket.emit("admin.rewards.save",a,function(a){if(a){app.alertError(a.message)}else{app.alertSuccess("[[admin/extend/rewards:alert.save-success]]")}})}return a});
//# sourceMappingURL=rewards.js.map