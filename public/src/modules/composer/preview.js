"use strict";define("composer/preview",function(){var e={};var i=0;e.render=function(e,n){n=n||function(){};if(!e.find(".preview-container").is(":visible")){return n()}if(i){clearTimeout(i);i=0}var r=e.find("textarea");i=setTimeout(function(){socket.emit("plugins.composer.renderPreview",r.val(),function(r,t){i=0;if(r){return}t=$("<div>"+t+"</div>");t.find("img:not(.not-responsive)").addClass("img-responsive");e.find(".preview").html(t);$(window).trigger("action:composer.preview");n()})},250)};e.matchScroll=function(e){if(!e.find(".preview-container").is(":visible")){return}var i=e.find("textarea");var n=e.find(".preview");if(i.length&&n.length){var r=i[0].scrollHeight-i.height();if(r===0){return}var t=i.scrollTop()/r;n.scrollTop(Math.max(n[0].scrollHeight-n.height(),0)*t)}};e.handleToggler=function(i){e.env=utils.findBootstrapEnvironment();function n(){t(false);if(e.env!=="xs"&&e.env!=="sm"){localStorage.setItem("composer:previewToggled",true)}}function r(){t(true);if(e.env!=="xs"&&e.env!=="sm"){localStorage.removeItem("composer:previewToggled")}}function t(n){if(e.env==="xs"||e.env==="sm"){l.toggleClass("hide",false);a.toggleClass("maximized",false);o.toggleClass("hide",true);l.toggleClass("hidden-xs hidden-sm",!n);a.toggleClass("hidden-xs hidden-sm",n);if(n){e.render(i,function(){})}}else{l.toggleClass("hide",!n);a.toggleClass("maximized",!n);o.toggleClass("hide",n);$(".write").focus()}e.matchScroll(i)}e.toggle=t;var o=i.find(".write-container .toggle-preview"),s=i.find(".preview-container .toggle-preview"),l=$(".preview-container"),a=$(".write-container");s.on("click",n);o.on("click",r);if(localStorage.getItem("composer:previewToggled")||(e.env==="xs"||e.env==="sm")){n()}else{r()}};return e});
//# sourceMappingURL=preview.js.map