(function(t,e){typeof exports==="object"&&typeof module!=="undefined"?module.exports=e():typeof define==="function"&&define.amd?define("pulling",e):t.Pulling=e()})(this,function(){"use strict";function t(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];function s(){this.constructor=t}t.prototype=e===null?Object.create(e):(s.prototype=e.prototype,new s)}function e(t,e){if(!t){throw TypeError("Invalid arguments: "+e)}}function n(){Element.prototype.matches=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector;Object.entries=function(t){return Object.keys(t).map(function(e){return[e,t[e]]})};Object.values=function(t){return Object.keys(t).map(function(e){return t[e]})};Object.assign=Object.assign||function(t){var e=[];for(var n=1;n<arguments.length;n++){e[n-1]=arguments[n]}for(var s=0,i=e;s<i.length;s++){var o=i[s];for(var r=0,a=Object.entries(o);r<a.length;r++){var u=a[r],l=u[0],h=u[1];t[l]=h}}return t};Array.prototype.includes=function t(e){return this.indexOf(e)!==-1}}var s=["linear","ease","ease-in","ease-out","ease-in-out","step-start","step-end"];var i=function(){function t(n){var i=this;this.styles={base:{menu:{},panel:{}},open:{menu:{},panel:{}},closed:{menu:{},panel:{}}};this.handlers={beforeclose:[],closed:[],beforeopen:[],opened:[],touchstart:[],touchmove:[],touchend:[]};this.state={opened:false,opening:false,closed:true,closing:false};this.disabled=false;if(!Object.values(t.modes).some(function(t){return i instanceof t})){throw TypeError("Calling this constructor is not allowed. "+"Use `Pulling.create` instead")}var o=n.menu,r=n.panel,a=n.side,u=n.mode,l=n.margin,h=n.timing,c=n.timingFunction,f=n.width,d=n.sensitivity,p=n.slope,m=n.touch;this.menu=o;this.panel=r;this.side=a||"left";this.mode=u||"drawer";this.margin=l||25,this.timing=h||200;this.timingFunction=c||"ease";this.width=f||256;this.sensitivity=d||.25;this.slope=p||.5;e(this.menu instanceof Element,"`menu` must be of type `Element`");e(this.panel instanceof Element,"`panel` must be of type `Element`");e(this.side==="left"||this.side==="right",'`side` must be equal to "left" or "right"');e(typeof this.margin==="number",'`margin` must be of type "number"');e(typeof this.timing==="number",'`timing` must be of type "number"');e(s.includes(this.timingFunction),"`timingFunction`"+" must be one of "+s.map(function(t){return'"'+t+'"'}).join(", "));e(typeof this.width==="number",'`width` must be of type "number"');e(typeof this.sensitivity==="number",'`sensitivity` must be of type "number"');e(typeof this.slope==="number",'`slope` must be of type "number"')}t.create=function(e){var n=e.mode||Object.keys(t.modes)[0]||"drawer";if(!t.modes[n]){var s=Object.keys(t.modes).map(function(t){return'"'+t+'"'}).join(", ");throw TypeError("`mode`"+" must be one of "+s)}return new t.modes[n](e)};t.prototype.emit=function(t,e){var n=this;this.handlers[t].forEach(function(t){return t.call(n,e)})};t.prototype.on=function(t,e){this.handlers[t].push(e);return this};t.prototype.off=function(t,e){if(e){this.handlers[t]=this.handlers[t].filter(function(t){return t!==e})}else{this.handlers[t]=[]}return this};t.prototype.open=function(t){var e=this;this.emit("beforeopen",t);if(this.disabled){return this}if(this.state.opened){return this}this.state.closed=false;this.state.closing=false;this.state.opening=true;this.state.opened=false;var n=this.offset();if(n>0){var s=this.timing*(1-n/this.width)+"ms";this.menu.style.transitionDuration=s;this.panel.style.transitionDuration=s}Object.assign(this.menu.style,this.styles.open.menu);Object.assign(this.panel.style,this.styles.open.panel);var i=function(){e.state.opening=false;e.state.opened=true;Object.assign(e.menu.style,e.styles.open.menu);Object.assign(e.panel.style,e.styles.open.panel);e.emit("opened")};if(n===this.width){i()}else{this.afterTransitionend(i)}return this};t.prototype.close=function(t){var e=this;this.emit("beforeclose",t);if(this.disabled){return this}if(this.state.closed){this.state.closing=false;return this}this.state.closed=false;this.state.closing=true;this.state.opening=false;this.state.opened=false;var n=this.offset();if(n>0){var s=this.timing*n/this.width+"ms";this.menu.style.transitionDuration=s;this.panel.style.transitionDuration=s}Object.assign(this.menu.style,this.styles.closed.menu);Object.assign(this.panel.style,this.styles.closed.panel);var i=function(){e.state.closing=false;e.state.closed=true;Object.assign(e.menu.style,e.styles.closed.menu);Object.assign(e.panel.style,e.styles.closed.panel);e.emit("closed")};if(n===0){i()}else{this.afterTransitionend(i)}return this};t.prototype.toggle=function(t){if(t===true){this.open()}else if(t===false){this.close()}else{this.toggle(this.state.closed||this.state.closing)}return this};t.prototype.disable=function(){this.disabled=true;return this};t.prototype.enable=function(){this.disabled=false;return this};t.prototype.afterTransitionend=function(t){};t.prototype.offset=function(){return 0};t.modes={};return t}();var o=function(e){t(n,e);function n(t){var n=e.call(this,t)||this;n.touched=false;n.ignores=[];n.ignoreSelector="";n.touch=t.touch!==false;n.ignoreScrollables=t.ignoreScrollables!==false;if(n.touch){n.addTouchEvents()}return n}n.prototype.applyOffset=function(t){};n.prototype.initTouchEvents=function(){var t=this;var e=this,n=e.width,s=e.margin,i=e.side,o=e.slope,r=e.sensitivity,a=e.menu,u=e.panel;var l=i==="left"?1:-1;var h=0;var c=0;var f=0;var d=0;var p=0;var m=0;var v=0;var y=false;var g=function(t){if(!t||t===document.documentElement||t===document.body){return false}var e=getComputedStyle(t),n=e.overflowX,s=e.overflowY;return n==="auto"||n==="scroll"||n==="visible"&&s!=="visible"||g(t.parentElement)};var b=function(e){var n=e.target;if(t.ignoreSelector&&n.matches(t.ignoreSelector)){return}if(t.ignoreScrollables&&g(n)){return}t.emit("touchstart",e);if(t.disabled){return}t.touched=false;if(e.touches.length!==1){return}var o=e.touches[0],r=o.clientX,a=o.clientY;var u=t.offset();var l=s+u;if(i==="left"&&r<=l||i==="right"&&window.innerWidth-r<=l){t.touched=true;h=r;c=a;f=r;d=u;m=Date.now();y=true}};var E=function(e){t.emit("touchmove",e);if(t.disabled||!t.touched){return}var s=e.touches[0],i=s.clientX,r=s.clientY;var g=(i-h)*l;if(Math.abs(g)<10){return}if(y){var b=r-c;var E=Math.abs(b/g);if(E>o){t.touched=false;return}if(t.state.closed&&g>0){t.emit("beforeopen")}else if(t.state.opened){t.emit("beforeopen")}a.style.transition=null;u.style.transition=null}if(t.state.opened&&g>0||t.state.closed&&g<0){f=i;m=Date.now();return}t.state.opened=false;t.state.closed=false;var w=(i-f)*l;var T=w>0;t.state.opening=T;t.state.closing=!T;var j=Math.min(Math.max(0,d+g),n);t.applyOffset(j);v=f;f=i;p=m;m=Date.now();y=false};var w=function(e){if(!t.touched){return}t.touched=false;if(y){return}t.emit("touchend",e);Object.assign(t.panel.style,t.styles.base.panel);Object.assign(t.menu.style,t.styles.base.menu);var s=t.offset();var i=e.changedTouches[0].clientX;var o;var a;if(i===f){o=v;a=p}else{o=f;a=m}var u=i;var h=Date.now();var c=(u-o)/(h-a)*l;if(s>n/2&&c>-r||c>r){t.open(e)}else{t.close(e)}};return{onTouchstart:b,onTouchmove:E,onTouchend:w}};n.prototype.addTouchEvents=function(){if(!this.touchEvents){this.touchEvents=this.initTouchEvents()}document.documentElement.addEventListener("touchstart",this.touchEvents.onTouchstart,false);document.documentElement.addEventListener("touchmove",this.touchEvents.onTouchmove,false);document.documentElement.addEventListener("touchend",this.touchEvents.onTouchend,false)};n.prototype.removeTouchEvents=function(){document.documentElement.removeEventListener("touchstart",this.touchEvents.onTouchstart);document.documentElement.removeEventListener("touchmove",this.touchEvents.onTouchmove);document.documentElement.removeEventListener("touchend",this.touchEvents.onTouchend)};n.prototype.ignore=function(t){this.ignores.push(t);this.ignoreSelector=this.ignores.join(", ");return this};n.prototype.unignore=function(t){this.ignores=this.ignores.filter(function(e){return e!==t});this.ignoreSelector=this.ignores.join(", ");return this};n.prototype.enableTouch=function(){if(!this.touch){this.addTouchEvents();this.touch=true}return this};n.prototype.disableTouch=function(){if(this.touch){this.removeTouchEvents();this.touch=false}return this};return n}(i);var r=function(e){t(n,e);function n(t){var n=e.call(this,t)||this;n.styles.base.menu=(s={transition:"transform "+n.timing+"ms "+n.timingFunction,overflowX:"hidden",overflowY:"auto",position:"fixed"},s[n.side]="-"+n.width+"px",s.top="0",s.bottom="0",s.width=n.width+"px",s.zIndex="1",s);n.styles.open.menu={transform:"translateX("+(n.side==="right"?"-":"")+n.width+"px)"};n.styles.closed.menu={transform:"translateX(0)"};Object.assign(n.menu.style,n.styles.base.menu,n.styles.closed.menu);Object.assign(n.panel.style,n.styles.base.panel,n.styles.closed.panel);n.initTransitionend();return n;var s}n.prototype.offset=function(){var t=this.menu.getBoundingClientRect();if(this.side==="left"){return t.left+this.width}return window.innerWidth-t.left};n.prototype.applyOffset=function(t){var e=this.side==="left"?1:-1;this.menu.style.transform="translateX("+t*e+"px)"};n.prototype.afterTransitionend=function(t){this.onTransitionend=t};n.prototype.initTransitionend=function(){var t=this;this.menu.addEventListener("transitionend",function(){if(t.onTransitionend){t.onTransitionend()}t.onTransitionend=null},false)};return n}(o);o.modes["drawer"]=r;n();return o});
//# sourceMappingURL=pulling-drawer.js.map