"use strict";define("taskbar",["benchpress","translator"],function(a,t){var i={};i.init=function(){var t=this;a.render("modules/taskbar",{}).then(function(a){t.taskbar=$(a);t.tasklist=t.taskbar.find("ul");$(document.body).append(t.taskbar);t.taskbar.on("click","li",function(){var a=$(this);var t=a.attr("data-module");var e=a.attr("data-uuid");require([t],function(t){if(!a.hasClass("active")){n();t.load(e);i.toggleNew(e,false);i.tasklist.removeClass("active");a.addClass("active")}else{t.minimize(e)}});return false})});$(window).on("action:app.loggedOut",function(){i.closeAll()})};i.close=function(a,t){var e=i.tasklist.find('[data-module="'+a+'"][data-uuid="'+t+'"]');var n="close";if(a==="chat"){n="closeByUUID"}if(e.length){require([a],function(a){if(typeof a[n]==="function"){a[n](t)}})}};i.closeAll=function(a){var t="[data-uuid]";if(a){t='[data-module="'+a+'"]'+t}i.tasklist.find(t).each(function(t,e){i.close(a||e.getAttribute("data-module"),e.getAttribute("data-uuid"))})};i.discard=function(a,t){var n=i.tasklist.find('[data-module="'+a+'"][data-uuid="'+t+'"]');n.remove();e()};i.push=function(a,t,e,n){n=n||function(){};var o=i.tasklist.find('li[data-uuid="'+t+'"]');var d={module:a,uuid:t,options:e,element:o};$(window).trigger("filter:taskbar.push",d);if(!o.length&&d.module){s(d,n)}else{n(o)}};i.get=function(a){var t=$('[data-module="'+a+'"]').map(function(a,t){return $(t).data()});return t};i.minimize=function(a,t){var e=i.tasklist.find('[data-module="'+a+'"][data-uuid="'+t+'"]');e.toggleClass("active",false)};i.toggleNew=function(a,t,e){var n=i.tasklist.find('[data-uuid="'+a+'"]');n.toggleClass("new",t);if(!e){$(window).trigger("action:taskbar.toggleNew",a)}};i.updateActive=function(a){var t=i.tasklist.find("li");t.removeClass("active");t.filter('[data-uuid="'+a+'"]').addClass("active");$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",true);$('[data-uuid="'+a+'"]:not([data-module])').toggleClass("modal-unfocused",false)};i.isActive=function(a){var t=i.tasklist.find('li[data-uuid="'+a+'"]');return t.hasClass("active")};function e(){var a=i.tasklist.find("li");if(a.length>0){i.taskbar.attr("data-active","1")}else{i.taskbar.removeAttr("data-active")}}function n(){i.tasklist.find(".active").removeClass("active")}function s(a,s){t.translate(a.options.title,function(t){var o=$("<div></div>").text(t||"NodeBB Task").html();var d=$("<li></li>").addClass(a.options.className).html('<a href="#"'+(a.options.image?" style=\"background-image: url('"+a.options.image+"'); background-size: cover;\"":"")+">"+(a.options.icon?'<i class="fa '+a.options.icon+'"></i> ':"")+'<span component="taskbar/title">'+o+"</span>"+"</a>").attr({title:o,"data-module":a.module,"data-uuid":a.uuid}).addClass(a.options.state!==undefined?a.options.state:"active");if(!a.options.state||a.options.state==="active"){n()}i.tasklist.append(d);e();a.element=d;d.data(a);$(window).trigger("action:taskbar.pushed",a);s(d)})}var o=function(a,t,i){switch(t){case"title":a.find('[component="taskbar/title"]').text(i);break;case"icon":a.find("i").attr("class","fa fa-"+i);break;case"image":a.find("a").css("background-image",'url("'+i+'")');break;case"background-color":a.find("a").css("background-color",i);break}};i.update=function(a,t,e){var n=i.tasklist.find('[data-module="'+a+'"][data-uuid="'+t+'"]');if(!n.length){return}var s=n.data();Object.keys(e).forEach(function(a){s[a]=e[a];o(n,a,e[a])});n.data(s)};return i});
//# sourceMappingURL=taskbar.js.map