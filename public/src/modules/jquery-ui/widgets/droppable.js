(function(e){if(typeof define==="function"&&define.amd){define(["jquery","./draggable","./mouse","../version","../widget"],e)}else{e(jQuery)}})(function(e){e.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:true,greedy:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=false;this.isout=true;this.accept=e.isFunction(s)?s:function(e){return e.is(s)};this.proportions=function(){if(arguments.length){t=arguments[0]}else{return t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}}};this._addToManager(i.scope);i.addClasses&&this._addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[];e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){var t=0;for(;t<e.length;t++){if(e[t]===this){e.splice(t,1)}}},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t)},_setOption:function(t,i){if(t==="accept"){this.accept=e.isFunction(i)?i:function(e){return e.is(i)}}else if(t==="scope"){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s);this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this._addActiveClass();if(i){this._trigger("activate",t,this.ui(i))}},_deactivate:function(t){var i=e.ui.ddmanager.current;this._removeActiveClass();if(i){this._trigger("deactivate",t,this.ui(i))}},_over:function(t){var i=e.ui.ddmanager.current;if(!i||(i.currentItem||i.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],i.currentItem||i.element)){this._addHoverClass();this._trigger("over",t,this.ui(i))}},_out:function(t){var i=e.ui.ddmanager.current;if(!i||(i.currentItem||i.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],i.currentItem||i.element)){this._removeHoverClass();this._trigger("out",t,this.ui(i))}},_drop:function(i,s){var o=s||e.ui.ddmanager.current,r=false;if(!o||(o.currentItem||o.element)[0]===this.element[0]){return false}this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var s=e(this).droppable("instance");if(s.options.greedy&&!s.options.disabled&&s.options.scope===o.options.scope&&s.accept.call(s.element[0],o.currentItem||o.element)&&t(o,e.extend(s,{offset:s.element.offset()}),s.options.tolerance,i)){r=true;return false}});if(r){return false}if(this.accept.call(this.element[0],o.currentItem||o.element)){this._removeActiveClass();this._removeHoverClass();this._trigger("drop",i,this.ui(o));return this.element}return false},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var t=e.ui.intersect=function(){function e(e,t,i){return e>=t&&e<t+i}return function(t,i,s,o){if(!i.offset){return false}var r=(t.positionAbs||t.position.absolute).left+t.margins.left,n=(t.positionAbs||t.position.absolute).top+t.margins.top,a=r+t.helperProportions.width,l=n+t.helperProportions.height,p=i.offset.left,u=i.offset.top,d=p+i.proportions().width,c=u+i.proportions().height;switch(s){case"fit":return p<=r&&a<=d&&u<=n&&l<=c;case"intersect":return p<r+t.helperProportions.width/2&&a-t.helperProportions.width/2<d&&u<n+t.helperProportions.height/2&&l-t.helperProportions.height/2<c;case"pointer":return e(o.pageY,u,i.proportions().height)&&e(o.pageX,p,i.proportions().width);case"touch":return(n>=u&&n<=c||l>=u&&l<=c||n<u&&l>c)&&(r>=p&&r<=d||a>=p&&a<=d||r<p&&a>d);default:return false}}}();e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,i){var s,o,r=e.ui.ddmanager.droppables[t.options.scope]||[],n=i?i.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;s<r.length;s++){if(r[s].options.disabled||t&&!r[s].accept.call(r[s].element[0],t.currentItem||t.element)){continue}for(o=0;o<a.length;o++){if(a[o]===r[s].element[0]){r[s].proportions().height=0;continue e}}r[s].visible=r[s].element.css("display")!=="none";if(!r[s].visible){continue}if(n==="mousedown"){r[s]._activate.call(r[s],i)}r[s].offset=r[s].element.offset();r[s].proportions({width:r[s].element[0].offsetWidth,height:r[s].element[0].offsetHeight})}},drop:function(i,s){var o=false;e.each((e.ui.ddmanager.droppables[i.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&t(i,this,this.options.tolerance,s)){o=this._drop.call(this,s)||o}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],i.currentItem||i.element)){this.isout=true;this.isover=false;this._deactivate.call(this,s)}});return o},dragStart:function(t,i){t.element.parentsUntil("body").on("scroll.droppable",function(){if(!t.options.refreshPositions){e.ui.ddmanager.prepareOffsets(t,i)}})},drag:function(i,s){if(i.options.refreshPositions){e.ui.ddmanager.prepareOffsets(i,s)}e.each(e.ui.ddmanager.droppables[i.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var o,r,n,a=t(i,this,this.options.tolerance,s),l=!a&&this.isover?"isout":a&&!this.isover?"isover":null;if(!l){return}if(this.options.greedy){r=this.options.scope;n=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===r});if(n.length){o=e(n[0]).droppable("instance");o.greedyChild=l==="isover"}}if(o&&l==="isover"){o.isover=false;o.isout=true;o._out.call(o,s)}this[l]=true;this[l==="isout"?"isover":"isout"]=false;this[l==="isover"?"_over":"_out"].call(this,s);if(o&&l==="isout"){o.isout=false;o.isover=true;o._over.call(o,s)}})},dragStop:function(t,i){t.element.parentsUntil("body").off("scroll.droppable");if(!t.options.refreshPositions){e.ui.ddmanager.prepareOffsets(t,i)}}};if(e.uiBackCompat!==false){e.widget("ui.droppable",e.ui.droppable,{options:{hoverClass:false,activeClass:false},_addActiveClass:function(){this._super();if(this.options.activeClass){this.element.addClass(this.options.activeClass)}},_removeActiveClass:function(){this._super();if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}},_addHoverClass:function(){this._super();if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}},_removeHoverClass:function(){this._super();if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}}})}return e.ui.droppable});
//# sourceMappingURL=droppable.js.map