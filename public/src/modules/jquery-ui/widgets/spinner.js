(function(t){if(typeof define==="function"&&define.amd){define(["jquery","./button","../version","../keycode","../safe-active-element","../widget"],t)}else{t(jQuery)}})(function(t){function i(t){return function(){var i=this.element.val();t.apply(this,arguments);this._refresh();if(i!==this.element.val()){this._trigger("change")}}}t.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:true,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);if(this.value()!==""){this._value(this.element.val(),true)}this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var i=this._super();var e=this.element;t.each(["min","max","step"],function(t,n){var s=e.attr(n);if(s!=null&&s.length){i[n]=s}});return i},_events:{keydown:function(t){if(this._start(t)&&this._keydown(t)){t.preventDefault()}},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){if(this.cancelBlur){delete this.cancelBlur;return}this._stop();this._refresh();if(this.previous!==this.element.val()){this._trigger("change",t)}},mousewheel:function(t,i){if(!i){return}if(!this.spinning&&!this._start(t)){return false}this._spin((i>0?1:-1)*this.options.step,t);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){if(this.spinning){this._stop(t)}},100);t.preventDefault()},"mousedown .ui-spinner-button":function(i){var e;e=this.element[0]===t.ui.safeActiveElement(this.document[0])?this.previous:this.element.val();function n(){var i=this.element[0]===t.ui.safeActiveElement(this.document[0]);if(!i){this.element.trigger("focus");this.previous=e;this._delay(function(){this.previous=e})}}i.preventDefault();n.call(this);this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;n.call(this)});if(this._start(i)===false){return}this._repeat(null,t(i.currentTarget).hasClass("ui-spinner-up")?1:-1,i)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(i){if(!t(i.currentTarget).hasClass("ui-state-active")){return}if(this._start(i)===false){return false}this._repeat(null,t(i.currentTarget).hasClass("ui-spinner-up")?1:-1,i)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance();this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content");this._addClass("ui-spinner-input");this.element.attr("role","spinbutton");this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",true).button({classes:{"ui-button":""}});this._removeClass(this.buttons,"ui-corner-all");this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up");this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down");this.buttons.first().button({icon:this.options.icons.up,showLabel:false});this.buttons.last().button({icon:this.options.icons.down,showLabel:false});if(this.buttons.height()>Math.ceil(this.uiSpinner.height()*.5)&&this.uiSpinner.height()>0){this.uiSpinner.height(this.uiSpinner.height())}},_keydown:function(i){var e=this.options,n=t.ui.keyCode;switch(i.keyCode){case n.UP:this._repeat(null,1,i);return true;case n.DOWN:this._repeat(null,-1,i);return true;case n.PAGE_UP:this._repeat(null,e.page,i);return true;case n.PAGE_DOWN:this._repeat(null,-e.page,i);return true}return false},_start:function(t){if(!this.spinning&&this._trigger("start",t)===false){return false}if(!this.counter){this.counter=1}this.spinning=true;return true},_repeat:function(t,i,e){t=t||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,i,e)},t);this._spin(i*this.options.step,e)},_spin:function(t,i){var e=this.value()||0;if(!this.counter){this.counter=1}e=this._adjustValue(e+t*this._increment(this.counter));if(!this.spinning||this._trigger("spin",i,{value:e})!==false){this._value(e);this.counter++}},_increment:function(i){var e=this.options.incremental;if(e){return t.isFunction(e)?e(i):Math.floor(i*i*i/5e4-i*i/500+17*i/200+1)}return 1},_precision:function(){var t=this._precisionOf(this.options.step);if(this.options.min!==null){t=Math.max(t,this._precisionOf(this.options.min))}return t},_precisionOf:function(t){var i=t.toString(),e=i.indexOf(".");return e===-1?0:i.length-e-1},_adjustValue:function(t){var i,e,n=this.options;i=n.min!==null?n.min:0;e=t-i;e=Math.round(e/n.step)*n.step;t=i+e;t=parseFloat(t.toFixed(this._precision()));if(n.max!==null&&t>n.max){return n.max}if(n.min!==null&&t<n.min){return n.min}return t},_stop:function(t){if(!this.spinning){return}clearTimeout(this.timer);clearTimeout(this.mousewheelTimer);this.counter=0;this.spinning=false;this._trigger("stop",t)},_setOption:function(t,i){var e,n,s;if(t==="culture"||t==="numberFormat"){e=this._parse(this.element.val());this.options[t]=i;this.element.val(this._format(e));return}if(t==="max"||t==="min"||t==="step"){if(typeof i==="string"){i=this._parse(i)}}if(t==="icons"){n=this.buttons.first().find(".ui-icon");this._removeClass(n,null,this.options.icons.up);this._addClass(n,null,i.up);s=this.buttons.last().find(".ui-icon");this._removeClass(s,null,this.options.icons.down);this._addClass(s,null,i.down)}this._super(t,i)},_setOptionDisabled:function(t){this._super(t);this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!t);this.element.prop("disabled",!!t);this.buttons.button(t?"disable":"enable")},_setOptions:i(function(t){this._super(t)}),_parse:function(t){if(typeof t==="string"&&t!==""){t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t}return t===""||isNaN(t)?null:t},_format:function(t){if(t===""){return""}return window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();if(t===null){return false}return t===this._adjustValue(t)},_value:function(t,i){var e;if(t!==""){e=this._parse(t);if(e!==null){if(!i){e=this._adjustValue(e)}t=this._format(e)}}this.element.val(t);this._refresh()},_destroy:function(){this.element.prop("disabled",false).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:i(function(t){this._stepUp(t)}),_stepUp:function(t){if(this._start()){this._spin((t||1)*this.options.step);this._stop()}},stepDown:i(function(t){this._stepDown(t)}),_stepDown:function(t){if(this._start()){this._spin((t||1)*-this.options.step);this._stop()}},pageUp:i(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:i(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){if(!arguments.length){return this._parse(this.element.val())}i(this._value).call(this,t)},widget:function(){return this.uiSpinner}});if(t.uiBackCompat!==false){t.widget("ui.spinner",t.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}})}return t.ui.spinner});
//# sourceMappingURL=spinner.js.map